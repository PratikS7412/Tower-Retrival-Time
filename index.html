<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tower Car Parking Retrieval Time Calculator</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; background-color: #f5f5f5; }
  input, select { padding: 5px; margin: 5px 0; width: 100%; max-width: 200px; }
  label { font-weight: bold; display: block; margin-top: 10px; }
  .card { border: 1px solid #ccc; padding: 15px; margin: 15px 0; border-radius: 8px; background-color: #fff; box-shadow: 2px 2px 8px rgba(0,0,0,0.1);}
  button { padding: 10px 20px; margin-top: 10px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 5px; }
  button:hover { background-color: #0056b3; }
  .result { font-weight: bold; margin-top: 20px; font-size: 1.2em; background: #e7f3ff; padding: 10px; border-radius: 5px; }
</style>
</head>
<body>

<h1>Tower Car Parking Retrieval Time Calculator</h1>

<div class="card">
  <h3>Speed Inputs</h3>
  <label>Lifting Speed (m/min):</label>
  <input type="number" id="liftingSpeed" value="60">

  <label>Traversing Speed (m/min):</label>
  <input type="number" id="traverseSpeed" value="20">

  <label>Rotation Speed (RPM):</label>
  <input type="number" id="rotationSpeed" value="2.2">
</div>

<div class="card">
  <h3>Pallet and Tower</h3>
  <label>Pallet Inner Size (mm):</label>
  <select id="palletInner">
    <option value="1900">1900</option>
    <option value="1950">1950</option>
    <option value="2000" selected>2000</option>
    <option value="2050">2050</option>
    <option value="2100">2100</option>
    <option value="2150">2150</option>
    <option value="2200">2200</option>
  </select>

  <label>Tower Combination:</label>
  <select id="towerCombo">
    <option value="0+1">0+1</option>
    <option value="0+2">0+2</option>
    <option value="0+3">0+3</option>
    <option value="1+1">1+1</option>
    <option value="1+2">1+2</option>
    <option value="1+3">1+3</option>
    <option value="2+2">2+2</option>
    <option value="2+3">2+3</option>
    <option value="3+3">3+3</option>
  </select>

  <label>Target Pallet Side:</label>
  <select id="targetSide">
    <option value="left">Left</option>
    <option value="right">Right</option>
  </select>

  <label>Target Pallet Position (1,2,3):</label>
  <input type="number" id="targetPosition" value="1" min="1" max="3">
</div>

<div class="card">
  <h3>Levels Configuration</h3>
  <label>Above Ground Levels:</label>
  <input type="number" id="aboveLevels" value="5" min="0">

  <label>First Level Height Above Ground (mm):</label>
  <input type="number" id="firstAboveHeight" value="2550">

  <label>Below Ground Levels:</label>
  <input type="number" id="belowLevels" value="2" min="0">

  <label>Slot Height B1 (mm):</label>
  <input type="number" id="b1Height" value="2100">

  <label>Entry Type for B1:</label>
  <select id="entryType">
    <option value="straight">Straight</option>
    <option value="90">90Â°</option>
  </select>

  <label>Other Below Ground Slot Height (B2, B3...) (mm):</label>
  <input type="number" id="otherBHeight" value="1800">
</div>

<div class="card">
  <label>Turn Table Required?</label>
  <select id="turnTable">
    <option value="no">No</option>
    <option value="yes">Yes</option>
  </select>
</div>

<button onclick="calculateTime()">Calculate Retrieval Time</button>

<div class="result" id="result"></div>

<script>
function calculateTime() {
  // Inputs
  let liftSpeedMMin = parseFloat(document.getElementById('liftingSpeed').value);
  let traverseSpeedMMin = parseFloat(document.getElementById('traverseSpeed').value);
  let rotationRPM = parseFloat(document.getElementById('rotationSpeed').value);
  let palletInner = parseFloat(document.getElementById('palletInner').value);
  let towerCombo = document.getElementById('towerCombo').value.split('+').map(Number);
  let aboveLevels = parseInt(document.getElementById('aboveLevels').value);
  let firstAboveHeight = parseFloat(document.getElementById('firstAboveHeight').value);
  let belowLevels = parseInt(document.getElementById('belowLevels').value);
  let b1Height = parseFloat(document.getElementById('b1Height').value);
  let entryType = document.getElementById('entryType').value;
  let otherBHeight = parseFloat(document.getElementById('otherBHeight').value);
  let turnTable = document.getElementById('turnTable').value;

  // Speeds in m/s
  let liftSpeed = liftSpeedMMin / 60;
  let traverseSpeed = traverseSpeedMMin / 60;

  // Traverse distance
  let traverseDist = (palletInner + 270)/1000; // meters
  let traverseExtra = 5;
  let liftExtra = 15;
  let doorTime = 20;
  let controlTime = 20;
  let additionalTime = 20;

  let maxSlotHeight = Math.max(firstAboveHeight, b1Height, otherBHeight);
  let allTimes = [];

  for(let sideIndex=0; sideIndex<2; sideIndex++){
    let palletsOnSide = towerCombo[sideIndex];
    for(let pos=1; pos<=palletsOnSide; pos++){
      // Shuffle
      let shuffles = pos>1 ? pos-1 : 0;
      let shuffleLiftTime = maxSlotHeight/1000 / liftSpeed + liftExtra;
      let shuffleTraverseTime = traverseDist/traverseSpeed + traverseExtra;
      let shuffleTimePer = shuffleLiftTime + shuffleTraverseTime;
      let totalShuffleTime = shuffles * shuffleTimePer;

      // Lift distance for target pallet (simplified above ground)
      let liftDist = firstAboveHeight /1000;
      let liftTime = liftDist / liftSpeed + liftExtra;
      let traverseTime = traverseDist / traverseSpeed + traverseExtra;

      // Rotation
      let rotationTime = 0;
      if(turnTable==='yes'){
        let degrees = 180; // straight entry assumed for simplicity
        let degPerSec = rotationRPM*360/60;
        rotationTime = degrees/degPerSec;
      }

      // Total
      let targetTime = liftTime + traverseTime + rotationTime + doorTime + controlTime + additionalTime;
      let totalTime = totalShuffleTime + targetTime;
      allTimes.push(totalTime);
    }
  }

  let totalTimeAll = allTimes.reduce((a,b)=>a+b,0);
  let minTime = Math.min(...allTimes);
  let maxTime = Math.max(...allTimes);
  let avgTime = totalTimeAll / allTimes.length;

  document.getElementById('result').innerHTML = `
    <p>Total Time (All Pallets): ${totalTimeAll.toFixed(2)} s</p>
    <p>Minimum Time (Single Pallet): ${minTime.toFixed(2)} s</p>
    <p>Maximum Time (Single Pallet): ${maxTime.toFixed(2)} s</p>
    <p>Average Time (Single Pallet): ${avgTime.toFixed(2)} s</p>
    <p><em>Note: Max slot height used for shuffle estimation; actual times may vary.</em></p>
  `;
}
</script>

</body>
</html>
